# JAVA授课通用支付接口

> 为了方便大家执行支付操作,重定向回调结果,非演示支付具体实现,特地提供一个支付接口
>
> 地址:http://ceshi.qfjava.cn:81/payment/weixinpay

## 一 原理

> 因微信扫码支付的特殊性,因此其无法提供地址重定向功能,需要我们自己编写 websocket 来实现功能,因此会导致授课时功能变负责,所以特地提供一个已经继承了 websocket 的支付页面和服务端,大家只要将订单号,商品名称,商品价格,和回调地址数据通过浏览器提交过去即可(页面 form 表单提交或者程序内部拼接后重定向),支付接口在支付完成后会自动指定重定向功能,跳转回你指定的页面

## 二 请求参数

| 参数名称    | 参数介绍   | 参数格式 | 示例                        | 是否必填 | 备注         |
| ------- | ------ | ---- | ------------------------- | ---- | ---------- |
| price   | 商品价格   | 字符串  | 1                         | 是    | 单位:分       |
| body    | 商品标题介绍 | 字符串  | 颈椎康复指南                    | 是    |            |
| orderId | 订单号    | 字符串  | dsd3sf3wsef               | 是    | 你网站的订单号    |
| url     | 回调地址   | 字符串  | http://localhost:8080/abc | 是    | 必须 http 开头 |

## 三 支付结果

> 当扫码支付完成后,程序会请求前面传递的回调地址接口,然后将结果传递过去
>
> 你在内部只需要判断支付结果,给对应的订单更改状态即可

| 参数名    | 值                                        |
| ------ | ---------------------------------------- |
| result | 下面 json 数据,注意参数名是 result, 值里面也是 result 开头 |

```json

{
  "result":
 	{
     "appid":"wx632c8f211f8122c6",
 	"bank_type":"CFT",
     "cash_fee":"1",
     "fee_type":"CNY",
     "is_subscribe":"Y",
     "mch_id":"1497984412",
     "nonce_str":"1631171182",
     "openid":"oUuptwrJudIfdihz1Z_T1AciMahs",
     "out_trade_no":"1221ea762d54496e83a33c9dab72f320",//订单编号
     "result_code":"SUCCESS",//支付结果
     "return_code":"SUCCESS",
     "sign":"5C7314AA4EB21772B42DBBCD65E56ACF",
     "time_end":"20180207163125",
     "total_fee":"1",//总支付价格
     "trade_type":"NATIVE",
     "transaction_id":"4200000065201802078895888133"},
 	 "type":0//类型 0为页面重定向,1为点对点服务器通信,因为是 localhost 地址,无法使用1
}
```

